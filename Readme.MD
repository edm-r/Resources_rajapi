# API Resource

Cette API permet de g√©rer des ressources (documents, fichiers, etc.) avec des fonctionnalit√©s de cr√©ation, mise √† jour et suppression.

## üîê Authentification
L'authentification est g√©r√©e via un microservice accessible √† l'URL :
```
https://rajapi-cop-auth-api.onrender.com/auth/token/
```
L'API utilise un syst√®me d'authentification bas√© sur des tokens (`Bearer Token`).

### üîπ Connexion
**URL:** `/auth/login/`  
**M√©thode:** `POST`

#### Exemple de requ√™te :
```bash
curl -X POST https://rajapi-cop-auth-api.onrender.com/auth/token/ \
     -H "Content-Type: application/json" \
     -d '{"email": "user@example.com", "password": "password123"}'
```
#### R√©ponse :
```json
{
  "token": "jwt_token_here",
  "user": {
    "email": "user@example.com",
    "username": "user123"
  }
}

## Points de terminaison (Endpoints)

### 1. Cr√©ation d'une ressource

- **URL**: `/api/resources/`
- **M√©thode**: `POST`
- **Authentification**: Requise (Token Microservice)
- **Permissions**: Utilisateur authentifi√©

**Corps de la requ√™te**:

```json
{
    "title": "Guide d'utilisation",
    "description": "Guide complet pour l'utilisation de l'application",
    "type": "document",
    "published_date": "2025-03-01",
    "status": "published",
    "file": [FICHIER_BINAIRE]
}
```

**R√©ponse r√©ussie (201 Created)**:

```json
{
    "id": 1,
    "title": "Guide d'utilisation",
    "description": "Guide complet pour l'utilisation de l'application",
    "type": "document",
    "file": "/media/resources/guide.pdf",
    "file_link": "http://example.com/media/resources/guide.pdf",
    "published_date": "2025-03-01",
    "status": "published"
}
```

**Exemple avec curl**:

```bash
curl -X POST \
  http://localhost:8000/api/resources/ \
  -H 'Authorization: Token your_auth_token' \
  -F 'title=Guide d'utilisation' \
  -F 'description=Guide complet pour l'utilisation de l'application' \
  -F 'type=document' \
  -F 'published_date=2025-03-01' \
  -F 'status=published' \
  -F 'file=@/chemin/vers/fichier.pdf'
```

### 2. Consultation d'une ressource

- **URL**: `/api/resources/{resource_id}/`
- **M√©thode**: `GET`
- **Authentification**: Requise (Token Microservice)
- **Permissions**: Utilisateur authentifi√© (auteur de la ressource)

**R√©ponse r√©ussie (200 OK)**:

```json
{
    "id": 1,
    "title": "Guide d'utilisation",
    "description": "Guide complet pour l'utilisation de l'application",
    "type": "document",
    "file": "/media/resources/guide.pdf",
    "file_link": "http://example.com/media/resources/guide.pdf",
    "published_date": "2025-03-01",
    "status": "published"
}
```

**Exemple avec curl**:

```bash
curl -X GET \
  http://localhost:8000/api/resources/1/ \
  -H 'Authorization: Token your_auth_token'
```

### 3. Mise √† jour compl√®te d'une ressource

- **URL**: `/api/resources/{resource_id}/`
- **M√©thode**: `PUT`
- **Authentification**: Requise (Token Microservice)
- **Permissions**: Utilisateur authentifi√© (auteur de la ressource)

**Corps de la requ√™te**:

```json
{
    "title": "Guide d'utilisation mis √† jour",
    "description": "Guide complet pour l'utilisation de l'application - Version 2",
    "type": "document",
    "published_date": "2025-03-02",
    "status": "published",
    "file": [FICHIER_BINAIRE_OPTIONNEL]
}
```

**R√©ponse r√©ussie (200 OK)**:

```json
{
    "id": 1,
    "title": "Guide d'utilisation mis √† jour",
    "description": "Guide complet pour l'utilisation de l'application - Version 2",
    "type": "document",
    "file": "/media/resources/guide_v2.pdf",
    "file_link": "http://example.com/media/resources/guide_v2.pdf",
    "published_date": "2025-03-02",
    "status": "published"
}
```

**Exemple avec curl**:

```bash
curl -X PUT \
  http://localhost:8000/api/resources/1/ \
  -H 'Authorization: Token your_auth_token' \
  -F 'title=Guide d'utilisation mis √† jour' \
  -F 'description=Guide complet pour l'utilisation de l'application - Version 2' \
  -F 'type=document' \
  -F 'published_date=2025-03-02' \
  -F 'status=published' \
  -F 'file=@/chemin/vers/fichier_v2.pdf'
```

### 4. Mise √† jour partielle d'une ressource

- **URL**: `/api/resources/{resource_id}/`
- **M√©thode**: `PATCH`
- **Authentification**: Requise (Token Microservice)
- **Permissions**: Utilisateur authentifi√© (auteur de la ressource)

**Corps de la requ√™te** (exemple de mise √† jour partielle):

```json
{
    "title": "Guide d'utilisation mis √† jour",
    "status": "draft"
}
```

**R√©ponse r√©ussie (200 OK)**:

```json
{
    "id": 1,
    "title": "Guide d'utilisation mis √† jour",
    "description": "Guide complet pour l'utilisation de l'application - Version 2",
    "type": "document",
    "file": "/media/resources/guide_v2.pdf",
    "file_link": "http://example.com/media/resources/guide_v2.pdf",
    "published_date": "2025-03-02",
    "status": "draft"
}
```

**Exemple avec curl**:

```bash
curl -X PATCH \
  http://localhost:8000/api/resources/1/ \
  -H 'Authorization: Token your_auth_token' \
  -H 'Content-Type: application/json' \
  -d '{
    "title": "Guide d'utilisation mis √† jour",
    "status": "draft"
  }'
```

### 5. Suppression d'une ressource

- **URL**: `/api/resources/{resource_id}/`
- **M√©thode**: `DELETE`
- **Authentification**: Requise (Token Microservice)
- **Permissions**: Utilisateur authentifi√© (auteur de la ressource)

**R√©ponse r√©ussie (204 No Content)**:
Pas de contenu retourn√©

**Exemple avec curl**:

```bash
curl -X DELETE \
  http://localhost:8000/api/resources/1/ \
  -H 'Authorization: Token your_auth_token'
```

## Mod√®le de donn√©es

Le mod√®le `Resource` comprend les champs suivants:

| Champ | Type | Description |
|-------|------|-------------|
| id | Integer | Identifiant unique (g√©n√©r√© automatiquement) |
| title | CharField | Titre de la ressource (max 100 caract√®res) |
| description | TextField | Description d√©taill√©e de la ressource |
| type | CharField | Type de ressource (document, image, etc.) |
| file | FileField | Fichier upload√© |
| published_date | DateField | Date de publication |
| author | ForeignKey | Auteur (utilisateur Django) |
| status | CharField | Statut ('draft' ou 'published') |
| created_at | DateTimeField | Date de cr√©ation (automatique) |
| updated_at | DateTimeField | Date de derni√®re mise √† jour (automatique) |


## Notes d'utilisation

- Les fichiers upload√©s sont stock√©s dans le dossier `MEDIA_ROOT/resources/`.
- Seul l'auteur d'une ressource peut la consulter, modifier ou la supprimer.
- L'authentification se fait via un token de microservice.
- Pour les mises √† jour partielles, utilisez la m√©thode PATCH au lieu de PUT.
- Pour obtenir l'URL compl√®te d'un fichier upload√©, utilisez le champ `file_link` dans la r√©ponse.